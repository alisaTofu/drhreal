########################################
# 0) Basic security / options
########################################

# ปิดการแสดงรายการไฟล์ในโฟลเดอร์
Options -Indexes


########################################
# 1) Rewrite rules (410 + HTTPS + non-www)
########################################
<IfModule mod_rewrite.c>
  RewriteEngine On

  # --- 1.1  Return 410 Gone for act_I.html ---
  # ให้ /act_I.html ตายสนิท เป็น 410 ไม่ว่าเรียกผ่าน www หรือไม่ก็ตาม
  RewriteCond %{REQUEST_URI} ^/act_I\.html$ [NC]
  RewriteRule ^ - [G,L]

  # --- 1.2  Force HTTPS + no-www ---
  # ถ้าเป็น http หรือมี www ให้ redirect ไป https://drhorrible.com/ แบบถาวร (301)
  RewriteCond %{HTTPS} off [OR]
  RewriteCond %{HTTP_HOST} ^www\.drhorrible\.com$ [NC]
  RewriteRule ^(.*)$ https://drhorrible.com/$1 [L,R=301]
</IfModule>


########################################
# 2) Default index file
########################################
DirectoryIndex index.html


########################################
# 3) Gzip Compression (ช่วยให้โหลดเร็วขึ้น)
########################################
<IfModule mod_deflate.c>
  # HTML, text, XML
  AddOutputFilterByType DEFLATE text/html text/plain text/xml

  # CSS & JS
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE text/javascript

  # JSON & XML API
  AddOutputFilterByType DEFLATE application/json application/xml

  # SVG
  AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>


########################################
# 4) Browser Caching (Static assets)
########################################
<IfModule mod_expires.c>
  ExpiresActive On

  # Images
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png  "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/gif  "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType image/x-icon "access plus 1 year"

  # CSS & JS
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType text/javascript "access plus 1 month"

  # Fonts
  ExpiresByType font/woff2 "access plus 1 year"
  ExpiresByType font/woff  "access plus 1 year"
</IfModule>

# เสริม cache-control ให้ CDN / proxy เข้าใจตรงกัน
<IfModule mod_headers.c>
  <FilesMatch "\.(js|css|png|jpg|jpeg|gif|webp|svg|ico|woff2?)$">
    Header set Cache-Control "public, max-age=2592000"
  </FilesMatch>
</IfModule>
